<!DOCTYPE html>
<html>

<head>
	<meta charset="utf-8" />
	<meta http-equiv="machine-ua-compatible" content="ie=edge" />
	<meta name="viewport" content="width=device-width, initial-scale=1" />
	<meta name="author" content="Lykon, Lollo, Neeja" />
	<title>Netkit Lab Generator</title>
	<link rel="stylesheet" href="assets/vendor/css/bootstrap.min.css" />
	<link rel="shortcut icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABjUlEQVQ4ja2RsW7aQByHP87ns2Mj180YlQeIOrBU4nmKisQ7IPECDCwMTHkIxIY6MdKFocrGGzTCjm2dzz6lA9gNahQpaX/TXyd99/3vd/CP6ex2u6/H4/HuHayN4/hbZ7PZ6H6/71VV9SbadV32+/2TNMZ4VVUxHo//XG3tX0Ce59T1EwDX1x9YLpcYYzoSoCxLAKbTKdvtlsPh0IJJklAUBdY6APi+z+Nj2jKiGQDm8zmDwYCbm08kSUKSJKSpJssMAN1uhFJXuK6iEQuAuq6x1jIajVitVtzf/2Q4HHJ7+xmtNb7v0+1GCOGgVIDv+9R1DYB8/t7FYkEQBFhrmc1mWOtcgEI4CCGQUrVdSQCtNXmeE8cxRVGcWw4JwyuUCk4m6QLgeQFZ9oDW+nRelmVbSFmWGGPOZX28sHpe0G4qhEPDyedfZYzBWovrhigVIKV7Ab4U2awShiFpmp7tDvALKRVZ9tBam3jeadZaIxtoMpm8anopaZoioyj6sV6vv7yZBnq93vf3cP83vwGLvrOpZ8u5AwAAAABJRU5ErkJggg=="
	/>
	<script src="views/helper.js"></script>
</head>

<body>
	<script>
		if (typeof JSON.clone !== "function") JSON.clone = function (obj) { return JSON.parse(JSON.stringify(obj)) }
		if (navigator.userAgent.indexOf('MSIE') !== -1 || navigator.appVersion.indexOf('Trident/') > 0)
			document.write('<p class="browserupgrade"><strong>Internet Explorer<\/strong> is not supported. Please upgrade your browser to <a href="https://www.google.com/chrome/browser/desktop/">Chrome<\/a> or <a href="https://www.mozilla.org/firefox/new/">Firefox<\/a>.<\/p>');
	</script>

	<!-- MAIN-->
	<div data-ng-app="napp" data-ng-controller="nc">
		<link rel="stylesheet" href="views/main.css" />
		<script src="assets/vendor/js/angular.min.js"></script>
		<script src="views/controller.js"></script>

		<!-- NAVBAR-->
		<div>
			<nav id="main-nav" class="navbar navbar-primary container-fluid navbar-kathara navbar-kathara-primary">
				<ul class="nav navbar-nav">
					<li>
						<a href="#home" onclick="toggle_tab(event, this)">Home</a>
					</li>
					<li>
						<a href="#graph" data-ng-click="makeGraphIfChanged(netkit)" onclick="toggle_tab(event, this)">Topology</a>
					</li>
					<li>
						<a onclick="toggle_submenu(0)">Download Lab</a>
					</li>
					<li>
						<a onclick="toggle_submenu(1)">Save &amp; Load</a>
					</li>
					<li id="run-on-host" class="hidden">
						<a onclick="toggle_submenu(2)" style="text-decoration: underline">Run on Host</a>
					</li>
					<li id="connect" class="hidden disabledLink">
						<a href="#sdn" onclick="if(!this.parentElement.classList.contains('disabledLink')){toggle_tab(event, this)}"
							style="text-decoration: underline">Connect...</a>
					</li>
				</ul>
			</nav>

			<!-- Sub-menu Download Lab -->
			<nav id="submenu-0" class="navbar navbar-primary navbar-kathara container-fluid navbar-kathara-secondary ng-hide">
				<script src="assets/vendor/js/jszip.min.js"></script>
				<ul class="nav navbar-nav">
					<li>
						<a data-ng-click="makeDownload(generateScript(netkit, labInfo), 'netkit.script')" onclick="toggle_submenu(-1)">Download .sh file</a>
					</li>
					<li>
						<a data-ng-click="generateZip(netkit, labInfo)" onclick="toggle_submenu(-1)">Download .zip file</a>
					</li>
				</ul>
			</nav>

			<!-- Sub-menu Save and Load -->
			<nav id="submenu-1" class="navbar container-fluid navbar-primary navbar-kathara navbar-kathara-secondary ng-hide">
				<script src="assets/vendor/js/FileSaver.min.js"></script>
				<input type="file" id="file" onchange="this.nextElementSibling.firstElementChild.firstElementChild.click()" style="display: none"/>
				<ul class="nav navbar-nav">
					<li>
						<a data-ng-click="import()" onclick="toggle_submenu(-1)">Import configuration</a>
					</li>
					<li>
						<a data-ng-click="makeDownload(generateConfig(netkit, labInfo), 'netkit.config')" onclick="toggle_submenu(-1)">Export configuration</a>
					</li>
				</ul>
			</nav>

			<!-- Sub-menu Run Lab -->
			<nav id="submenu-2" class="navbar navbar-primary navbar-kathara navbar-kathara-secondary ng-hide container-fluid">
				<ul class="nav navbar-nav">
					<li>
						<a id="copyLab">Copy lab on Host *</a>
					</li>
					<li>
						<a id="lstart" class="disabledLink">Run LStart on Host **</a>
					</li>
					<li>
						<a id="lclean" class="disabledLink">Run LClean on Host **</a>
					</li>
				</ul>
				<div>
					<span class="label label-warning">
						* Host must be able to run bash commands
					</span>
					<br />
					<span class="label label-warning">
						** Requires Kathar&aacute; installed on Host and correctly configured.
					</span>
				</div>
			</nav>
		</div>

		<!-- CONTENTS -->
		<div class="tab-content">

			<!-- HOME -->
			<div id="home" class="tab-pane active">
				<link rel="stylesheet" href="views/home/home.css" />
				<script src="views/home/model.js"></script>
				<script src="views/home/make.js"></script>

				<div>
					<h1>Netkit Lab Generator</h1>
					<h4>
						<a href="https://github.com/Kidel/Netkit-Lab-Generator" target="_blank">https://github.com/Kidel/Netkit-Lab-Generator</a>
					</h4>
					<hr/>
					<p>
						This tool allows to quickly generate most of the files and folders you need to run a working netkit lab. The main purpose
						is to quickly generate the files and folders needed with low configuration options, so more advanced funtionalities
						are omitted and some others are set by default (like zebra username and password). The tool also allows to visualize
						the topology in the 'Graph' tab.
					</p>
					<p>
						Once the form is compiled just download the bash script or the .zip file with the whole lab. It is also possible to export
						and import the form configuration for future changes. DNS may not work with too many levels.
					</p>
					<p class="disclaimer">The
						<a href="https://github.com/Kidel/Netkit-Lab-Generator/graphs/contributors" target="_blank">authors</a>
						of this application do not take any responsibility for any malfunction. Remember to manually check the final configuration
						for exams and production.
						<a class="link" onclick="this.parentElement.classList.add('hidden');document.getElementsByClassName('mock-disclaimer').item(0).className = ''">click to close</a>
					</p>
					</p>
				</div>

				<!-- RIGHT MENU -->
				<div id="right-controls">
					<table id="labInfo">
						<tbody>
							<tr>
								<th>Lab informations</th>
							</tr>

							<tr>
								<td>
									<label>Description:
										<input type="text" data-ng-model="labInfo.description" class="form-control" placeholder="Exam 2-A 'Harpoon'" />
									</label>
									<label>Version:
										<input type="text" data-ng-model="labInfo.version" class="form-control" placeholder="1.0" />
									</label>
									<label>Author(s):
										<input type="text" data-ng-model="labInfo.author" class="form-control" placeholder="M. Rossi, F. Bianchi" />
									</label>
									<label>Email:
										<input type="email" data-ng-model="labInfo.email" class="form-control" placeholder="m.rossi@provider.dom" />
									</label>
									<label>Website:
										<input type="text" data-ng-model="labInfo.web" class="form-control" placeholder="http://yoursite.dom" />
									</label>
								</td>
							</tr>

							<tr class="xs-floating-right">
								<td>
									<p class="btn btn-success" data-ng-click="addMachine()">Add machine</p>
									<p class="btn btn-danger" data-ng-click="removeMachine()" data-ng-disabled="counter<=1">Remove last machine</p>
								</td>
							</tr>

							<tr>
								<td>
									<label>Preview: </label>
									<div id="minimap">
										<div id="minimap-body" ng-style="{ 'transform': 'scale(1, ' + minimap_transform + ')' }">

											<span id="mock-main-menu" class="mock mock-main-menu"></span>

											<div class="mock mock-preview-text">Netkit Lab Generator</div>
											<div class="mock mock-preview-text">The authors of this application do not take any responsibility for any malfunction. Remember to manually check
												the final configuration for exams and production.</div>
											<span class="mock mock-disclaimer"></span>

											<span id="mock-main-menu" class="mock mock-main-menu"></span>
											<div data-ng-repeat="machine in netkit track by $index" class="btn btn-default mock mock-machine" ng:class="{true:'mock-machine', false:''}[$index==0]"
											 data-ng-click="scrollTo($event, machine._uid)" ng-style="compensationScale[$index]">
												<span class="mock-id">{{$index+1}}</span>{{machine.name}}</div>

											<div class="mock mock-preview-text">Bash file preview:</div>
											<span class="mock mock-preview-bash"></span>

										</div>
									</div>
								</td>
							</tr>
						</tbody>
					</table>
				</div>

				<!-- NETWORK TABLE -->
				<table id="netkit">
					<tbody>

						<tr>
							<th>Machine informations</th>
							<th>Network interfaces</th>
							<th>Gateway (static):</th>
							<th>Additional functions</th>
						</tr>

						<!-- each row is a machine -->
						<tr data-ng-repeat="machine in netkit track by $index">
							<td>
								<div id="{{machine._uid}}" class="anchor-id"></div>
								<div>
									<label>Machine {{machine.row}}:</label>
									<input type="text" data-ng-model="machine.name" class="form-control" placeholder="pc{{machine.row}}" required />
								</div>
								<p>
									<input title="type" type="radio" value="terminal" data-ng-model="machine.type" /> Terminal</p>
								<p>
									<input title="type" type="radio" value="router" data-ng-model="machine.type" /> Router</p>
								<p>
									<input title="type" type="radio" value="ns" data-ng-model="machine.type" /> Name Server</p>
								<p>
									<input title="type" type="radio" value="ws" data-ng-model="machine.type" /> Web Server</p>
								<p data-ng-show="toggleOVSwitchSelection(netkit, this.machine.type)">
									<input title="type" type="radio" value="switch" data-ng-model="machine.type" /> Open vSwitch</p>
								<p data-ng-show="toggleControllerSelection(netkit, this.machine.type)">
									<input title="type" type="radio" value="controller" data-ng-model="machine.type" /> OpenFlow Ryu controller</p>
								<p>
									<input title="type" type="radio" value="other" data-ng-model="machine.type" /> Other</p>
								<div data-ng-show="machine.type == 'other'">
									<label>Image Name:</label>
									<input type="text" data-ng-model="machine.other.image" class="form-control" required placeholder="e.g.: p4" required />
								</div>
							</td>

							<td class="interfaces">
								<p style="color:darkgray" data-ng-hide="(machine.type != 'switch' && machine.type != 'controller')">
									Connection between switches and controller is automatically configured
								</p>
								<div data-ng-hide="machine.type == 'controller'">
									<p>
										<span class="btn btn-success" data-ng-click="addInterface(machine)">Add interface</span>
										<span class="btn btn-danger" data-ng-click="removeInterface(machine)" data-ng-disabled="machine.interfaces.counter<=1">Remove last interface</span>
									</p>
									<div data-ng-repeat="i in machine.interfaces.if">
										<div data-ng-hide="(machine.type == 'switch' && i.eth.number == 0)">
											<div>
												<label>Eth{{i.eth.number}}: </label>
												<input type="text" data-ng-model="i.eth.domain" class="form-control" placeholder="A" required />
											</div>
											<div data-ng-show="machine.type!='switch'">
												<label> IP/Net: </label>
												<input type="text" data-ng-model="i.ip" class="form-control" placeholder="0.0.0.0/0" pattern="(^$)|(((^|\.)((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]?\d))){4}/[0-9]+$)" />
											</div>
											<div data-ng-show="machine.type!='switch'">
												<label> Complete DNS Name: </label>
												<input type="text" data-ng-model="i.name" class="form-control" placeholder="www.x.y. or ROOT-SERVER." pattern=".*\.$" />
											</div>
											<hr>
										</div>
									</div>
								</div>
								<label>Directly in {{machine.name}}.startup:</label>
								<textarea title="free" rows="3" class="form-control" data-ng-model="machine.interfaces.free"></textarea>
							</td>

							<td class="gateways">
								<div data-ng-show="machine.type!='switch' && machine.type!='controller'">
									<p>
										<span class="btn btn-success" data-ng-click="addGateway(machine)">
											Add gateway</span>
										<span class="btn btn-danger" data-ng-click="removeGateway(machine)" data-ng-disabled="machine.gateways.counter<=1">
											Remove last gw</span>
									</p>
									<div data-ng-repeat="gateway in machine.gateways.gw">
										<div>
											<label>Route (empty for default gw):</label>
											<input type="text" data-ng-model="gateway.route" class="form-control" placeholder="0.0.0.0/0" pattern="((^|\.)((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]?\d))){4}/[0-9]+$" />
										</div>
										<div>
											<label>GW (empty to generate nothing):</label>
											<input type="text" data-ng-model="gateway.gw" class="form-control" placeholder="0.0.0.0" pattern="((^|\.)((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]?\d))){4}$" />
										</div>
										<div>
											<label>Interface:</label>
											<select title="eth" data-ng-model="gateway.if" class="form-control">
												<option data-ng-repeat="i in machine.interfaces.if" value="{{i.eth.number}}">eth{{i.eth.number}}</option>
											</select>
										</div>
										<hr>
									</div>
								</div>
							</td>

							<td>
								<div data-ng-show="machine.type=='terminal'">
									<label>Reference DNS (resolv.conf nameserver):</label>
									<select title="en" data-ng-model="machine.pc.dns">
										<option value="-" selected>-</option>
										<optgroup data-ng-repeat="m in netkit" data-ng-if="m.type == 'ns' && m.ns.recursion" label="{{m.name}}">
											<option data-ng-repeat="ifn in m.interfaces.if" value="{{ifn.ip.split('/')[0]}}">{{ifn.ip.split('/')[0]}}</option>
										</optgroup>
									</select>
								</div>

								<div data-ng-show="machine.type=='ns'">
									<p>
										<input title="auth" type="checkbox" value="1" data-ng-model="machine.ns.authority" /> I am a Nameserver Authority</p>
									<div data-ng-show="machine.ns.authority">
										<label>Zone (root is .):</label>
										<input type="text" data-ng-model="machine.ns.zone" class="form-control" placeholder=".com." pattern="(^\..*\.$)|^.$" required />
									</div>
									<p>
										<input title="rec" type="checkbox" value="1" data-ng-model="machine.ns.recursion" /> Enable recursive</p>
								</div>

								<div data-ng-show="machine.type=='ws'">
									<input title="userdir" type="checkbox" value="1" data-ng-model="machine.ws.userdir" /> Enable
									<strong>userdir</strong> module?
								</div>

								<div data-ng-show="machine.type =='switch'">
								</div>

								<div data-ng-show="machine.type=='controller'">
									<p style="color: darkgray">
										(After the lab starts, you will be able to connect to this controller through a dedicated button in the navigation bar)
									</p>
									<hr>
									<p>Ryu startup applications:</p>
									<p>
										<input data-ng-model="machine.ryu.simple"
											type="checkbox" >Simple switch
									</p>
									<p>
										<input data-ng-model="machine.ryu.stp"
											type="checkbox" >Simple switch with spanning tree protocol
									</p>
									<p>
										<input data-ng-model="machine.ryu.rest"
											type="checkbox" >OpenFlow REST Controller
									</p>
									<p>
										Other: 
										<input data-ng-model="machine.ryu.custom"
											type="text" placeholder="&lt;app-name&gt;.py [&lt;app-name&gt;.py ...]"
											style="background-image: none; width: 210px; padding: 1px 10px;">
									</p>
								</div>

								<div data-ng-show="machine.type=='other'">
									<p class="btn btn-success" data-ng-click="addFile(machine)">Add file</p>
									<p class="btn btn-danger" data-ng-click="removeFile(machine)" data-ng-disabled="machine.other.files<=1">Remove last file</p>
									<p>(files will be stored in /etc/scripts/)</p>
									<div data-ng-repeat="fl in machine.other.files">
										<div>
											<label>File name:</label>
											<input type="text" data-ng-model="fl.name" class="form-control" placeholder="e.g: my_switch.p4" required />
										</div>
										<div>
											<label>File contents:</label>
											<textarea title="free" rows="3" class="form-control" data-ng-model="fl.contents"></textarea>
										</div>
									</div>
								</div>
								<div data-ng-show="machine.type=='router'">
									<label>Dynamic routing: </label>
									<p>
										<input title="en" type="checkbox" value="router" data-ng-model="machine.routing.rip.en" /> rip</p>

									<div data-ng-show="machine.routing.rip.en">
										<span class="btn btn-success" data-ng-click="addRipNetwork(machine)">Add Network</span>
										<span class="btn btn-danger" data-ng-click="removeRipNetwork(machine)" data-ng-disabled="machine.routing.rip.network.length<=1">Remove Network</span>
										<div data-ng-repeat="rnet in machine.routing.rip.network track by $index">
											<label>Network: </label>
											<input type="text" placeholder="0.0.0.0/0" required pattern="((^|\.)((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]?\d))){4}/[0-9]+$"
											 class="form-control" data-ng-model="machine.routing.rip.network[$index]" />
										</div>
										<hr>
										<span class="btn btn-success" data-ng-click="addRipRoute(machine)">Add Route</span>
										<span class="btn btn-danger" data-ng-click="removeRipRoute(machine)" data-ng-disabled="machine.routing.rip.route.length<=1">Remove Route</span>
										<div data-ng-repeat="rroute in machine.routing.rip.route track by $index">
											<label>Route (empty to omit): </label>
											<input type="text" placeholder="0.0.0.0/0" pattern="((^|\.)((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]?\d))){4}/[0-9]+$" class="form-control"
											 data-ng-model="machine.routing.rip.route[$index]" />
										</div>

										<div>
											<input title="redistributeo" type="checkbox" value="1" data-ng-model="machine.routing.rip.ospf" /> redistribute ospf</div>
										<div>
											<input title="redistributeb" type="checkbox" value="1" data-ng-model="machine.routing.rip.bgp" /> redistribute bgp</div>
										<div>
											<input title="redistributec" type="checkbox" value="1" data-ng-model="machine.routing.rip.connected" /> redistribute connected</div>
										<label>Directly in ripd.conf:</label>
										<textarea title="free" rows="3" class="form-control" data-ng-model="machine.routing.rip.free"></textarea>
										<hr>
									</div>

									<p>
										<input title="en" type="checkbox" value="ns" data-ng-model="machine.routing.ospf.en" /> ospf</p>

									<div data-ng-show="machine.routing.ospf.en">
										<span class="btn btn-success" data-ng-click="addOspfNetwork(machine)">Add Network</span>
										<span class="btn btn-danger" data-ng-click="removeOspfNetwork(machine)" data-ng-disabled="machine.routing.ospf.network.length<=1">Remove Newtork</span>
										<div data-ng-repeat="onet in machine.routing.ospf.network track by $index">
											<div>
												<label>Network: </label>
												<input type="text" placeholder="0.0.0.0/0" required pattern="((^|\.)((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]?\d))){4}/[0-9]+$"
												 class="form-control" data-ng-model="machine.routing.ospf.network[$index]" />
											</div>
											<div>
												<label>Area: </label>
												<input type="text" placeholder="0.0.0.0" required pattern="((^|\.)((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]?\d))){4}$" class="form-control"
												 data-ng-model="machine.routing.ospf.area[$index]" />
											</div>
											<input title="stub" type="checkbox" value="1" data-ng-model="machine.routing.ospf.stub[$index]" /> stub?
										</div>

										<div>
											<input title="redistributer" type="checkbox" value="1" data-ng-model="machine.routing.ospf.rip" /> redistribute rip</div>
										<div>
											<input title="redistributeb" type="checkbox" value="1" data-ng-model="machine.routing.ospf.bgp" /> redistribute bgp</div>
										<div>
											<input title="redistributec" type="checkbox" value="1" data-ng-model="machine.routing.ospf.connected" /> redistribute connected</div>
										<label>Cost: </label>
										<div data-ng-repeat="o in machine.interfaces.if">
											<div>
												<input type="text" placeholder="0" class="form-control" data-ng-model="machine.routing.ospf.if[o.eth.number].cost" pattern="[0-9]*" />
											</div>
											<select title="eth" data-ng-model="machine.routing.ospf.if[o.eth.number].interface" class="form-control">
												<option data-ng-repeat="i in machine.interfaces.if" value="{{i.eth.number}}">eth{{i.eth.number}}</option>
											</select>
										</div>
										<label>Directly in ospfd.conf:</label>
										<textarea title="free" rows="3" class="form-control" data-ng-model="machine.routing.ospf.free"></textarea>
										<hr>
									</div>
									<p>
										<input title="en" type="checkbox" value="router" data-ng-model="machine.routing.bgp.en" /> bgp</p>
									<div data-ng-show="machine.routing.bgp.en">
										<label>AS: </label>
										<input type="text" placeholder="0" pattern="^[0-9]*$" class="form-control" data-ng-model="machine.routing.bgp.as" required />
										<span class="btn btn-success" data-ng-click="addBgpNetwork(machine)">Add Network</span>
										<span class="btn btn-danger" data-ng-click="removeBgpNetwork(machine)" data-ng-disabled="machine.routing.bgp.network.length<=1">Remove Network</span>
										<div data-ng-repeat="bnet in machine.routing.bgp.network track by $index">
											<label>Network: </label>
											<input type="text" placeholder="0.0.0.0/0" pattern="((^|\.)((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]?\d))){4}/[0-9]+$" class="form-control"
											 data-ng-model="machine.routing.bgp.network[$index]" />
										</div>
										<span class="btn btn-success" data-ng-click="addBgpNeighbor(machine)">Add Neighbor</span>
										<span class="btn btn-danger" data-ng-click="removeBgpNeighbor(machine)" data-ng-disabled="machine.routing.bgp.remote.length<=1">Remove Neighbor</span>
										<div data-ng-repeat="bremote in machine.routing.bgp.remote track by $index">
											<label>Neighbor (empty to omit): </label>
											<input type="text" placeholder="0.0.0.0" pattern="((^|\.)((25[0-5])|(2[0-4]\d)|(1\d\d)|([1-9]?\d))){4}$" class="form-control"
											 data-ng-model="machine.routing.bgp.remote[$index].neighbor" />
											<label>Remote-AS: </label>
											<input type="text" placeholder="0" pattern="^[0-9]*$" class="form-control" data-ng-model="machine.routing.bgp.remote[$index].as" />
											<label>Description: </label>
											<input type="text" title="description" class="form-control" data-ng-model="machine.routing.bgp.remote[$index].description" />
										</div>
										<div>
											<label>Directly in bgpd.conf:</label>
											<textarea title="free" rows="3" class="form-control" data-ng-model="machine.routing.bgp.free"></textarea>
										</div>
									</div>
								</div>
							</td>
						</tr>
					</tbody>
				</table>

				<!-- BASH PREVIEW -->
				<div class="bash">
					<h3>Bash file preview:</h3>
					<textarea id="sh_script" title="script" rows="15" readonly>{{ generateScript(netkit, labInfo) }}</textarea>
				</div>

			</div>

			<!-- GRAPH -->
			<div id="graph" class="tab-pane">
				<script src="assets/vendor/js/vis.js"></script>
				<script src="views/graph/make_draw_model.js"></script>
				<script src="views/graph/draw.js"></script>
				<button style="margin-bottom: 15px" class="btn btn-primary" data-ng-click="makeGraph(netkit)">Reload</button>
				<div id="mynetwork" style="height: 80vh; border: 1px solid lightgray;"></div>
			</div>

			<!-- CONNECT -->
			<div id="sdn" class="tab-pane">
				<link rel="stylesheet" href="views/sdn/sdn.css" />
				<div class="schede">
					<div style="transform: scale(1.1); margin: 30px; opacity: 1">
						<h1>Connect to controller</h1>
						<hr>
						<p>
							In order to connect to the controller, be sure that a <b>REST controller</b>
							is running, then clik the button below.
							A new node will be added to the Kathar&aacute; simulated enviroment.
							This node will act as an intermediary between the host and the controller.
							It will host a server which will provide an interface for managing the
							flow tables of the controller. Once created,
							<a onclick="electron.shell.openExternal('http://localhost:8080/index.html?ip=192.168.100.1:8080')" target="_blank">click here</a>
							or visit <span style="text-decoration: underline">http://localhost:8080/</span>
							on your web browser.
							<p class="disclaimer">Be sure all containers have started before connecting!</p>
						</p>
						<hr>
						<div style="margin: 10px auto; width: fit-content">
							<!-- <p>
								Select a free IP for the new temporary node:
								<input type="text" class="TODO" placeholder="192.168.100.254"/>
							</p> -->
							<button class="btn btn-default" onclick="attachInterfaceToController(this, this.nextElementSibling)">
								Attach interface
							</button>
							<button class="btn btn-danger hidden" onclick="detachInterfaceToController(this, this.previousElementSibling)">
								Detach
							</button>
						</div>
					</div>
					<div>
						<h1>Pull the Docker image</h1>
						<hr>
						<p>
							The node which acts as an interface between the external world and the simulated enviroment
							is a special docker container whose image must be pulled from docker registry or built from source.
							So, if you have not done that yet, simply run <code>docker pull kathara/netkit_extended</code>
							in your terminal.
						</p>
						<p class="disclaimer">
							Please make sure you downloaded the image before trying to connect to the controller
						</p>
					</div>
					<div>
						<h1>Build the image from sources <span style="color: darkgray; font-size: x-large">(alternative)</span></h1>
						<hr>
						<p>
							The default image for the interface node can be found
							<a href="https://github.com/Pastello/Netkit-SDN-Interface">here</a>.
							If you want to download and build or modify it on your own, you can run
							<code>git clone https://github.com/Pastello/Netkit-SDN-Interface &lt;local-directory&gt;</code>
							then run <code>sh build.sh</code> to build it.
						</p>
					</div>
					<div>
						<h1>Connect to controller with command line <span style="color: darkgray; font-size: x-large">(alternative)</span></h1>
						<hr>
						<p>
							To use a custom image or a custom port for the interface node, you can manually start it with these commands:
							<ul style="padding-left: 10px">
								<li>
									Create and run the container and expose its port 3000 to the host container:
									<code>docker run -it --privileged=true -p &lt;port&gt;:3000 --name &lt;machine-name&gt; kathara/netkit_extended</code>
								</li>
								<li>
									Then you need to connect the new node to the Kathar&aacute; network:
									<code>docker network connect netkit_1000_SDNRESERVED &lt;machine-name&gt;</code>
								</li>
								<li>
									Finally an IPv4 must be assigned to the machine:
									<code>docker exec &lt;machine-name&gt; ifconfig eth1 &lt;ip&gt; up</code>
								</li>
							</ul>
						</p>
					</div>
					<div>
						<h1>Set Docker permissions <span style="color: darkgray; font-size: x-large">(optional)</span></h1>
						<hr>
						<p>
							Kathar&aacute; uses docker to create the virtual enviroment. Some docker commands need
							superuser permissions in order to be executed. If you are useing linux, an easy alternative
							way to properly configure and launch docker containers is adding current user to
							the 'docker' group. You can do that by simply running
							<code>sudo usermod -aG docker $(whoami)</code> in your favourite terminal.
						</p>
					</div>
				</div>
			</div>

		</div>
	</div>

	<!-- LSTART MODAL -->
	<div id="command-modal" class="modal modal-kathara ng-hide">
		<div class="modal-dialog">
			<div class="modal-content">
				<div class="modal-header">
					<button type="button" class="close" onclick="close_modal('command-modal')">&times;</button>
					<h4 class="modal-title">Running Commands</h4>
				</div>
				<div class="modal-body">
					<p>The command has been issued, please wait for its execution.</p>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-warning" onclick="this.disabled = true; close_modal('command-modal')" disabled>Ok, I understand</button>
				</div>
			</div>
		</div>
	</div>

	<script>
		var electron

		window.onload = function () {
			console.log("  _______          __   __    __  __    \n  \\      \\   _____/  |_|  | _|__|/  |_  \n  /   |   \\_/ __ \\   __\\  |/ /  \\   __\\ \n /    |    \\  ___/|  | |    <|  ||  |   \n \\____|__  /\\___  >__| |__|_ \\__||__|   \n         \\/     \\/          \\/         ");

			if (isElectron()) {
				electron = require('electron')

				document.querySelector("#run-on-host").classList.remove("hidden")
				document.getElementById('copyLab').addEventListener('click', copyLab)
				document.getElementById('lstart').addEventListener('click', executeStart)
				document.getElementById('lclean').addEventListener('click', executeClean)
			}
		}
	</script>
</body>

</html>